function bv = basis_x(n,x,y,vertices,deg)

L1=[ones(1,3);vertices']'\[1;0;0];
L2=[ones(1,3);vertices']'\[0;1;0];
L3=[ones(1,3);vertices']'\[0;0;1];

L12 = L1(2);  L22 = L2(2);  L32 = L3(2);

L1 = L1'*[1 x y]';
L2 = L2'*[1 x y]';
L3 = L3'*[1 x y]';


if deg == 1
    
    if n==1
    bv = L12;
elseif n==2
    bv = L22;
elseif n==3
    bv = L32;
    end
    
elseif deg == 2
    if n == 1
 bv = -L12 + 4*L1*L12;
elseif n == 2
 bv = -L22 + 4*L2*L22;
elseif n == 3
 bv = -L32 + 4*L3*L32;
elseif n == 4
 bv = 4*L12*L2 + 4*L1*L22;
elseif n == 5
 bv = 4*L22*L3 + 4*L2*L32;
elseif n == 6
 bv = 4*L12*L3 + 4*L1*L32;
    end

elseif deg == 3
    if n==1
    bv = L12 - 9*L1*L12 + (27*L1^2*L12)/2;
elseif n==2
    bv = L22 - 9*L2*L22 + (27*L2^2*L22)/2;
elseif n==3
    bv = L32 - 9*L3*L32 + (27*L3^2*L32)/2;
elseif n==4
    bv = (-9*L12*L2)/2 + 27*L1*L12*L2 - (9*L1*L22)/2 + (27*L1^2*L22)/2;
elseif n==5
    bv = (-9*L12*L2)/2 + (27*L12*L2^2)/2 - (9*L1*L22)/2 + 27*L1*L2*L22;
elseif n==6
    bv = (-9*L22*L3)/2 + 27*L2*L22*L3 - (9*L2*L32)/2 + (27*L2^2*L32)/2;
elseif n==7
    bv = (-9*L22*L3)/2 + (27*L22*L3^2)/2 - (9*L2*L32)/2 + 27*L2*L3*L32;
elseif n==8
    bv = (-9*L12*L3)/2 + (27*L12*L3^2)/2 - (9*L1*L32)/2 + 27*L1*L3*L32;
elseif n==9
    bv = (-9*L12*L3)/2 + 27*L1*L12*L3 - (9*L1*L32)/2 + (27*L1^2*L32)/2;
elseif n==10
    bv =27*L12*L2*L3 + 27*L1*L22*L3 + 27*L1*L2*L32;
else
    end

elseif deg==4
if n == 1
 bv = -L12 + (44*L1*L12)/3 - 48*L1^2*L12 + (128*L1^3*L12)/3;
elseif n == 2
 bv = -L22 + (44*L2*L22)/3 - 48*L2^2*L22 + (128*L2^3*L22)/3;
elseif n == 3
 bv = -L32 + (44*L3*L32)/3 - 48*L3^2*L32 + (128*L3^3*L32)/3;
elseif n == 4
 bv = (16*L12*L2)/3 - 64*L1*L12*L2 + 128*L1^2*L12*L2 + (16*L1*L22)/3 - 32*L1^2*L22 + (128*L1^3*L22)/3;
elseif n == 5
 bv = 4*L12*L2 - 32*L1*L12*L2 - 16*L12*L2^2 + 128*L1*L12*L2^2 + 4*L1*L22 - 16*L1^2*L22 - 32*L1*L2*L22 + 128*L1^2*L2*L22;
elseif n == 6
 bv = (16*L12*L2)/3 - 32*L12*L2^2 + (128*L12*L2^3)/3 + (16*L1*L22)/3 - 64*L1*L2*L22 + 128*L1*L2^2*L22;
elseif n == 7
 bv = (16*L22*L3)/3 - 64*L2*L22*L3 + 128*L2^2*L22*L3 + (16*L2*L32)/3 - 32*L2^2*L32 + (128*L2^3*L32)/3;
elseif n == 8
 bv = 4*L22*L3 - 32*L2*L22*L3 - 16*L22*L3^2 + 128*L2*L22*L3^2 + 4*L2*L32 - 16*L2^2*L32 - 32*L2*L3*L32 + 128*L2^2*L3*L32;
elseif n == 9
 bv = (16*L22*L3)/3 - 32*L22*L3^2 + (128*L22*L3^3)/3 + (16*L2*L32)/3 - 64*L2*L3*L32 + 128*L2*L3^2*L32;
elseif n == 10
 bv = (16*L12*L3)/3 - 32*L12*L3^2 + (128*L12*L3^3)/3 + (16*L1*L32)/3 - 64*L1*L3*L32 + 128*L1*L3^2*L32;
elseif n == 11
 bv = 4*L12*L3 - 32*L1*L12*L3 - 16*L12*L3^2 + 128*L1*L12*L3^2 + 4*L1*L32 - 16*L1^2*L32 - 32*L1*L3*L32 + 128*L1^2*L3*L32;
elseif n == 12
 bv = (16*L12*L3)/3 - 64*L1*L12*L3 + 128*L1^2*L12*L3 + (16*L1*L32)/3 - 32*L1^2*L32 + (128*L1^3*L32)/3;
elseif n == 13
 bv = -32*L12*L2*L3 - 32*L1*L22*L3 + 128*L12*L2*L3^2 + 128*L1*L22*L3^2 - 32*L1*L2*L32 + 256*L1*L2*L3*L32;
elseif n == 14
 bv = -32*L12*L2*L3 + 128*L12*L2^2*L3 - 32*L1*L22*L3 + 256*L1*L2*L22*L3 - 32*L1*L2*L32 + 128*L1*L2^2*L32;
elseif n == 15
 bv = -32*L12*L2*L3 + 256*L1*L12*L2*L3 - 32*L1*L22*L3 + 128*L1^2*L22*L3 - 32*L1*L2*L32 + 128*L1^2*L2*L32;
end
elseif deg==5
    if n == 1
 bv = L12 - (125*L1*L12)/6 + (875*L1^2*L12)/8 - (625*L1^3*L12)/3 + (3125*L1^4*L12)/24;
elseif n == 2
 bv = L22 - (125*L2*L22)/6 + (875*L2^2*L22)/8 - (625*L2^3*L22)/3 + (3125*L2^4*L22)/24;
elseif n == 3
 bv = L32 - (125*L3*L32)/6 + (875*L3^2*L32)/8 - (625*L3^3*L32)/3 + (3125*L3^4*L32)/24;
elseif n == 4
 bv = (-25*L12*L2)/4 + (1375*L1*L12*L2)/12 - (1875*L1^2*L12*L2)/4 + (3125*L1^3*L12*L2)/6 - (25*L1*L22)/4 + (1375*L1^2*L22)/24 - (625*L1^3*L22)/4 + (3125*L1^4*L22)/24;
elseif n == 5
 bv = (-25*L12*L2)/6 + (125*L1*L12*L2)/2 - (625*L1^2*L12*L2)/4 + (125*L12*L2^2)/6 - (625*L1*L12*L2^2)/2 + (3125*L1^2*L12*L2^2)/4 - (25*L1*L22)/6 + (125*L1^2*L22)/4 - (625*L1^3*L22)/12 + (125*L1*L2*L22)/3 - (625*L1^2*L2*L22)/2 + (3125*L1^3*L2*L22)/6;
elseif n == 6
 bv = (-25*L12*L2)/6 + (125*L1*L12*L2)/3 + (125*L12*L2^2)/4 - (625*L1*L12*L2^2)/2 - (625*L12*L2^3)/12 + (3125*L1*L12*L2^3)/6 - (25*L1*L22)/6 + (125*L1^2*L22)/6 + (125*L1*L2*L22)/2 - (625*L1^2*L2*L22)/2 - (625*L1*L2^2*L22)/4 + (3125*L1^2*L2^2*L22)/4;
elseif n == 7
 bv = (-25*L12*L2)/4 + (1375*L12*L2^2)/24 - (625*L12*L2^3)/4 + (3125*L12*L2^4)/24 - (25*L1*L22)/4 + (1375*L1*L2*L22)/12 - (1875*L1*L2^2*L22)/4 + (3125*L1*L2^3*L22)/6;
elseif n == 8
 bv = (-25*L22*L3)/4 + (1375*L2*L22*L3)/12 - (1875*L2^2*L22*L3)/4 + (3125*L2^3*L22*L3)/6 - (25*L2*L32)/4 + (1375*L2^2*L32)/24 - (625*L2^3*L32)/4 + (3125*L2^4*L32)/24;
elseif n == 9
 bv = (-25*L22*L3)/6 + (125*L2*L22*L3)/2 - (625*L2^2*L22*L3)/4 + (125*L22*L3^2)/6 - (625*L2*L22*L3^2)/2 + (3125*L2^2*L22*L3^2)/4 - (25*L2*L32)/6 + (125*L2^2*L32)/4 - (625*L2^3*L32)/12 + (125*L2*L3*L32)/3 - (625*L2^2*L3*L32)/2 + (3125*L2^3*L3*L32)/6;
elseif n == 10
 bv = (-25*L22*L3)/6 + (125*L2*L22*L3)/3 + (125*L22*L3^2)/4 - (625*L2*L22*L3^2)/2 - (625*L22*L3^3)/12 + (3125*L2*L22*L3^3)/6 - (25*L2*L32)/6 + (125*L2^2*L32)/6 + (125*L2*L3*L32)/2 - (625*L2^2*L3*L32)/2 - (625*L2*L3^2*L32)/4 + (3125*L2^2*L3^2*L32)/4;
elseif n == 11
 bv = (-25*L22*L3)/4 + (1375*L22*L3^2)/24 - (625*L22*L3^3)/4 + (3125*L22*L3^4)/24 - (25*L2*L32)/4 + (1375*L2*L3*L32)/12 - (1875*L2*L3^2*L32)/4 + (3125*L2*L3^3*L32)/6;
elseif n == 12
 bv = (-25*L12*L3)/4 + (1375*L12*L3^2)/24 - (625*L12*L3^3)/4 + (3125*L12*L3^4)/24 - (25*L1*L32)/4 + (1375*L1*L3*L32)/12 - (1875*L1*L3^2*L32)/4 + (3125*L1*L3^3*L32)/6;
elseif n == 13
 bv = (-25*L12*L3)/6 + (125*L1*L12*L3)/3 + (125*L12*L3^2)/4 - (625*L1*L12*L3^2)/2 - (625*L12*L3^3)/12 + (3125*L1*L12*L3^3)/6 - (25*L1*L32)/6 + (125*L1^2*L32)/6 + (125*L1*L3*L32)/2 - (625*L1^2*L3*L32)/2 - (625*L1*L3^2*L32)/4 + (3125*L1^2*L3^2*L32)/4;
elseif n == 14
 bv = (-25*L12*L3)/6 + (125*L1*L12*L3)/2 - (625*L1^2*L12*L3)/4 + (125*L12*L3^2)/6 - (625*L1*L12*L3^2)/2 + (3125*L1^2*L12*L3^2)/4 - (25*L1*L32)/6 + (125*L1^2*L32)/4 - (625*L1^3*L32)/12 + (125*L1*L3*L32)/3 - (625*L1^2*L3*L32)/2 + (3125*L1^3*L3*L32)/6;
elseif n == 15
 bv = (-25*L12*L3)/4 + (1375*L1*L12*L3)/12 - (1875*L1^2*L12*L3)/4 + (3125*L1^3*L12*L3)/6 - (25*L1*L32)/4 + (1375*L1^2*L32)/24 - (625*L1^3*L32)/4 + (3125*L1^4*L32)/24;
elseif n == 16
 bv = (125*L12*L2*L3)/3 + (125*L1*L22*L3)/3 - (625*L12*L2*L3^2)/2 - (625*L1*L22*L3^2)/2 + (3125*L12*L2*L3^3)/6 + (3125*L1*L22*L3^3)/6 + (125*L1*L2*L32)/3 - 625*L1*L2*L3*L32 + (3125*L1*L2*L3^2*L32)/2;
elseif n == 17
 bv = (125*L12*L2*L3)/4 - (625*L12*L2^2*L3)/4 + (125*L1*L22*L3)/4 - (625*L1*L2*L22*L3)/2 - (625*L12*L2*L3^2)/4 + (3125*L12*L2^2*L3^2)/4 - (625*L1*L22*L3^2)/4 + (3125*L1*L2*L22*L3^2)/2 + (125*L1*L2*L32)/4 - (625*L1*L2^2*L32)/4 - (625*L1*L2*L3*L32)/2 + (3125*L1*L2^2*L3*L32)/2;
elseif n == 18
 bv = (125*L12*L2*L3)/3 - (625*L12*L2^2*L3)/2 + (3125*L12*L2^3*L3)/6 + (125*L1*L22*L3)/3 - 625*L1*L2*L22*L3 + (3125*L1*L2^2*L22*L3)/2 + (125*L1*L2*L32)/3 - (625*L1*L2^2*L32)/2 + (3125*L1*L2^3*L32)/6;
elseif n == 19
 bv = (125*L12*L2*L3)/4 - (625*L1*L12*L2*L3)/2 + (125*L1*L22*L3)/4 - (625*L1^2*L22*L3)/4 - (625*L12*L2*L3^2)/4 + (3125*L1*L12*L2*L3^2)/2 - (625*L1*L22*L3^2)/4 + (3125*L1^2*L22*L3^2)/4 + (125*L1*L2*L32)/4 - (625*L1^2*L2*L32)/4 - (625*L1*L2*L3*L32)/2 + (3125*L1^2*L2*L3*L32)/2;
elseif n == 20
 bv = (125*L12*L2*L3)/4 - (625*L1*L12*L2*L3)/2 - (625*L12*L2^2*L3)/4 + (3125*L1*L12*L2^2*L3)/2 + (125*L1*L22*L3)/4 - (625*L1^2*L22*L3)/4 - (625*L1*L2*L22*L3)/2 + (3125*L1^2*L2*L22*L3)/2 + (125*L1*L2*L32)/4 - (625*L1^2*L2*L32)/4 - (625*L1*L2^2*L32)/4 + (3125*L1^2*L2^2*L32)/4;
elseif n == 21
 bv = (125*L12*L2*L3)/3 - 625*L1*L12*L2*L3 + (3125*L1^2*L12*L2*L3)/2 + (125*L1*L22*L3)/3 - (625*L1^2*L22*L3)/2 + (3125*L1^3*L22*L3)/6 + (125*L1*L2*L32)/3 - (625*L1^2*L2*L32)/2 + (3125*L1^3*L2*L32)/6;
    end
end
end



















